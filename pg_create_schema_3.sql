drop table dcad_main;
create table dcad_main (
ccode1 int references cow_country_codes (ccode),
cowName1 varchar(3),
ccode2 int references cow_country_codes (ccode),
cowName2 varchar(3),
signDay int,
signMonth int,
signYear int,
EIFDay int,
EIFMonth int,
EIFYear int,
type varchar,
category1 varchar,
category2 varchar,
category3 varchar,
span int,
renewType int,
renewYears int,
terminated int,
durationActual int,
endYearEstimate int,
asymmetry int,
categoryConf varchar,
UNTS int,
fullText varchar,
sourceType varchar,
source varchar,
factivaConf int,
factivaSign int,
factivaEIF int,
DCAid varchar);

select * from majors2016;

/*insert into cow_country_codes (stateabb) values ('GER');
insert into cow_country_codes (stateabb) values ('FRG');
delete from cow_country_codes where stateabb = 'GER' or stateabb = 'FRG';*/

select * from cow_country_codes;

create table dcad_dyadic (
ccode1 int references cow_country_codes (ccode),
abbrev1	varchar(3) references cow_country_codes (stateabb),
ccode2 int references cow_country_codes (ccode),
abbrev2 varchar(3) references cow_country_codes (stateabb),
year int,
dcaGeneralV1 int,
dcaGeneralV2 int,
dcaSectorV1 int,
dcaSectorV2 int,
dcaAnyV1 int,
dcaAnyV2 int);

create table national_cow (
ccode int references cow_country_codes (ccode),
statename varchar,
stateabb varchar(3) references cow_country_codes (stateabb),
year int,
imports double precision,
exports double precision,
alt_imports double precision,
alt_exports	double precision,
source1	double precision,
source2 double precision,
version double precision
);

create table dyadic_cow (
ccode1 int references cow_country_codes (ccode),
ccode2 int references cow_country_codes (ccode),
year int,
importer1 varchar,
importer2 varchar,
flow1 numeric,
flow2 numeric,
smoothflow1 numeric,
smoothflow2 numeric,
smoothtotrade numeric,
spike1 numeric,
spike2 numeric,
dip1 numeric,
dip2 numeric,
trdspike numeric,
tradedip numeric,
bel_lux_alt_flow1 numeric,
bel_lux_alt_flow2 numeric,
china_alt_flow1 numeric,
china_alt_flow2 numeric,
source1 numeric,
source2 numeric,
version double precision
);

drop table dyadic_format_v3;
create table dyadic_format_v3 (
ccode1 int references cow_country_codes (ccode),
country1 varchar,
ccode2 int references cow_country_codes (ccode),
country2 varchar,
year int,
state varchar,
AALCO int,
AATA int,
ACDT int,
ACPEU int,
ANZUS int,
AP int,
APT int,
BALTBAT int,
BC int,
BENELUX int,
BSEC int,
CACI int,
CBSS int,
CCNR int,
CComm int,
CENTO int,
CHSTEA int,
CIS int,
COE int,
ComSec int,
EAPC int,
EIPA int,
ESA int,
Entente int,
G15 int,
G24 int,
G3 int,
GLACSEC int,
IADefB int,
IAHC int,
IARHC int,
IASAJ int,
ICAmO int,
ICCILMB int,
ICivDO int,
IDC	int,
IOCom int,
IOMig int,
ITTO int,
IUPIP int,
LOAS int,
LoN int,
MFO int,
NAM int,
NATO int,
NCM int,
NordC int,
OAS int,
OAU int,
OCAS int,
OCR int,
OPANAL int,
OSCE int,
PAHO int,
PCA int,
PIF int,
PMAESA int,
RCC int,
RIOgroup int,
RepCom int,
SAARC int,
SCHENGEN int,
SEATO int,
SPC int,
UN int,
USP int,
WCDC int,
WEU int,
WPact int,
Wassen int,
AU int,
CSTO int,
Corg int,
EIP int,
IORARC int,
UM int,
SWPD int,
SCO int,
RECSA int,
BOBP int,
CICA int,
FEC int,
IRU int,
IUIC int,
PAP int,
RCFC int,
SEGIB int,
ACCT int,
ACI int,
ACML int,
ACSO int,
AFTE int,
ARCAL int,
ASATP int,
ASCBC int,
ASEF int,
AmCC int,
AralSea int,
ArticC int,
BCSC int,
BIISEF int,
BIONET int,
CAB int,
CABI int,
CAIPA int,
CAMES int,
CBI int,
CELC int,
CMHASG int,
COLOMBO int,
CONFEJES int,
COSAVE int,
CPAB int,
CPSC int,
CTCAf int,
CWGC int,
CXC int,
Danube int,
ECCD int,
EFCC int,
EFILWC int,
EMBC int,
EMBL int,
EMPPO int,
ESO int,
ETF int,
EUFMD int,
EURATOM int,
GBACT int,
GCRSNC int,
GEF int,
IABE int,
IABath int,
IACI int,
IACS int,
IACSS int,
IACW int,
IAEA int,
IAIAS int,
IAMLO int,
IAPhy int,
IARadiO int,
IARuhr int,
IATSJ int,
IBE int,
IBI int,
IBIER int,
IBPMP int,
ICAO int,
ICCROM int,
ICCS int,
ICDR int,
ICES int,
ICHRB int,
ICMMP int,
ICPRP int,
ICRI int,
ICRPBC int,
ICTM int,
IEC int,
IES	int,
IEXB int,
IHO	int,
IIE int,
ILO	int,
IMBSlav int,
IMC int,
IMI int,
INCAP int,
INFSMK int,
INTERPOL int,
IOEz int,
IOLM int,
IOPH int,
IPedI int,
IPentC int,
IPhyL int,
IRLCS int,
IRO int,
ISA int,
ISHREST int,
ISUPT int,
ITCC int,
ITCLE int,
IUPLAW int,
JALAAO int,
JINR int,
JNOLCRH int,
LACAC int,
LACP int,
LAEO int,
LAIEC int,
LATIN int,
LCBC int,
MCPTTC int,
MCWCASM int,
MWN int,
Montreal int,
NAPPO int,
NASCO int,
NCRR int,
NEAFC int,
NPAFC int,
NPFSC int,
NTSC int,
OCCEDCA int,
OIC int,
OMDKR int,
OSLO int,
OSPAR int,
PAIGH int,
PC int,
PCSP int,
PICES int,
PICS int,
PSNARCO int,
RCAELA int,
RIMMO int,
RIOPPAH int,
SACEP int,
SCAf int,
SCH int,
SEAMEO int,
SWAPU int,
Turksoy int,
UNESCO int,
VASAB int,
WAEC int,
WAHC int,
WHO int,
WMO	int,
ALSF int,
AMCOW int,
CBFP int,
CSLF int,
CfRN int,
GEO int,
GHSI int,
IAII int,
ICPTU int,
IGCC int,
INPFC int,
IRENA int,
ISuC int,
WAHO int,
PAPU int,
MAOCN int,
MARRI int,
NPI int,
NWHF int,
AfricaRice int,
BORGIP int,
CILSS int,
EURAMET int,
ICFAM int,
IIFEO int,
IIWEE int,
ISRBC int,
ITRO int,
NAFO int,
NVC int,
OIV int,
PIBAC int,
VALDIVIA int,
UNIDROIT int,
AAAID int,
AACB int,
AARO int,
AATPO int,
ABEDA int,
ABEPSEAC int,
ACC int,
ACP int,
ACS int,
ACSSRB int,
ACU int,
AFESD int,
AFEXIMB int,
AFGEC int,
AFPU int,
AFRAND int,
AGC int,
AGPUNDO int,
AIC int,
AIDC int,
AIDO int,
AIOEC int,
AIPO int,
ALO int,
AMCO int,
AMF int,
AMIPO int,
AMPTU int,
AMSC int,
AMU int,
AOAD int,
AOCRS int,
AOMR int,
AOPU int,
APCC int,
APEC int,
APFIC int,
APIBD int,
APO	int,
APPA int,
APTU int,
ARC int,
ARIPO int,
ARPU int,
ASBLAC int,
ASCRubber int,
ASEAN int,
ASECNA int,
ASPAC int,
ATO int,
ATPC int,
AVRDC int,
AfDB int,
AfrOPDA int,
Africare int,
Andean int,
AsDB int,
BIPM int,
BIS int,
BNDP int,
BONN int,
CAAD int,
CAARC int,
CACB int,
CAEC int,
CAECC int,
CAMRSD int,
CAMSF int,
CARICOM int,
CARIFTA int,
CARII int,
CATC int,
CCOM int,
CCPA int,
CDB int,
CEAO int,
CEC int,
CEEPN int,
CEFTA int,
CEI int,
CEMAC int,
CEPGL int,
CERN int,
CFATF int,
CFC	int,
CIFC int,
CIMA int,
CMAEC int,
CMAOC int,
CMEA int,
COMESA int,
COPTAC int,
CPU int,
CTO int,
ComAB int,
DBGLS int,
DLCOEA int,
EACM int,
EACSO int,
EADB int,
EAPO int,
EBRD int,
ECB int,
ECCA int,
ECCAS int,
ECCB int,
ECCM int,
ECCPIF int,
ECO int,
ECOWAS int,
ECPTA int,
ECSC int,
EEC int,
EFTA int,
EIB	int,
ELDO int,
EMB int,
EMI	int,
EPA int,
EPFSC int,
EPO int,
ESRO int,
EU int,
EUROCONTROL int,
EUROFIMA int,
EUROMET int,
FAO int,
FDIPLAC int,
GATT int,
GCC int,
GOIC int,
HCPIL int,
IACB int,
IADB int,
IAFC int,
IAIC int,
IAIGC int,
IALong int,
IARA int,
IAS int,
IATB int,
IATTC int,
IBA int,
IBCS int,
IBEC int,
IBRD int,
ICAC int,
ICAI int,
ICC int,
ICCEC int,
ICCO int,
ICCSLT int,
ICNC int,
ICNWAF int,
ICSE int,
ICSEAF int,
ICSG int,
ICfO int,
IChemO int,
IComO int,
IEA int,
IFAD int,
IFC int,
IFCA int,
IGAD int,
IGC int,
IIA int,
IICom int,
IIF int,
IJO int,
ILZSG int,
IMF int,
IMO int,
IMSO int,
INFOFISH int,
INRO int,
INSG int,
INTELSAT int,
IOATHRE int,
IOOC int,
IOPCF int,
IOcC int,
IPC int,
IPI int,
IPrizeC int,
IRSG int,
ISB	int,
ISDB int,
ITC int,
ITPA int,
ITU int,
ITVRC int,
IUPCT int,
IUPNVP int,
IUPR int,
IVWO int,
IWSG int,
IWhale int,
Iocean int,
LAFDO int,
LAFTA int,
LAIA int,
LGIDA int,
MIGA int,
MRU int,
Mercosur int,
NACAP int,
NAFTA int,
NCTR int,
NDF int,
NERC int,
NIB int,
NRC int,
OAPEC int,
OCAM int,
OECD int,
OECS int,
OEEC int,
OPEC int,
OTIF int,
PAHC int,
PCB int,
PED int,
PIARC int,
PIPD int,
PTASEA int,
PUASP int,
RASCOM int,
RadioU int,
SAAFA int,
SACU int,
SADC int,
SADCC int,
SAMI int,
SARTC int,
SCA int,
SELA int,
SICA int,
SIECA int,
SITTDEC int,
SRDO int,
SugU int,
TCRMG int,
UASC int,
UBEC int,
UDEAC int,
UEMOA int,
UIUCV int,
UKDWD int,
UMAC int,
UMOA int,
UNIDO int,
UPU int,
WCO int,
WIPO int,
WNF int,
WTO int,
WTOURO int,
ACWL int,
AFSPC int,
AITIC int,
BS int,
D8 int,
EAC int,
EAEC int,
EPU int,
ERIA int,
AFRISTAT int,
OMVG int);

select * from dyadic_format_v3;

alter table dyadic_format_v3
add primary key (ccode1, ccode2, year);

alter table dyadic_cow
rename to trade_dyadic;

alter table national_cow
rename to trade_national;

select * from trade_dyadic;

alter table trade_dyadic
add primary key (ccode1, ccode2, year);

select * from trade_national;

alter table trade_national
add primary key (ccode, year);

select * from dcad_main;

alter table dcad_main
add primary key (dcaid);